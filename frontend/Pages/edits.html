<!-- ============================================
     LearnHub - Edit Student Page (edits.html)
     ============================================
     This page provides a form for editing existing student information.
     It pre-populates form fields with current student data and includes validation.

     Features:
     - Pre-populated form fields with existing student data
     - Form validation with real-time feedback
     - Duplicate checking for student ID and email
     - Flash message support for user feedback
     - Bootstrap responsive form layout
     - Font Awesome icons for visual elements
     - JavaScript form validation and submission handling

     Dependencies:
     - Bootstrap 5.1.3 for form components and layout
     - Font Awesome 6.0.0 for icons
     - Custom CSS (styles.css) for styling
     - Custom JavaScript (scripts.js) for validation

     Form Fields:
     - student_id: Unique identifier (required, integer)
     - name: Full student name (required)
     - age: Student age (required, 1-150)
     - email: Email address (required, unique)
     - courses: Optional course list (comma-separated)

     Template Variables:
     - student: Tuple/list containing student data (id, student_id, name, age, email, created_date)
     - courses: List of courses for the student

     API Endpoints:
     - POST /edit_student/{student_id}: Form submission endpoint
     ============================================ -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Document metadata and character encoding -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LearnHub - Edit Student</title>

    <!-- Favicon -->
    <link
      rel="icon"
      href="{{ url_for('static', filename='images/LearnHub.png') }}"
      type="image/png"
    />
    <!-- External CSS Dependencies -->
    <!-- Font Awesome for form icons and visual elements -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <!-- Bootstrap for form layout and components -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Custom CSS for form-specific styling -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
  </head>
  <body>
    <!-- ============================================
         NAVIGATION BAR
         ============================================
         Main navigation with LearnHub branding and menu items.
         No specific page is marked as active (generic navigation).
         ============================================ -->
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container">
        <!-- Brand logo and home link -->
        <a class="navbar-brand" href="/">
          <i class="fas fa-graduation-cap me-2"></i> LearnHub
        </a>
        <!-- Mobile menu toggle -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <!-- Navigation menu -->
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <!-- Home link -->
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="fas fa-home me-1"></i> Home
              </a>
            </li>
            <!-- Dashboard link -->
            <li class="nav-item">
              <a class="nav-link" href="dashboard">
                <i class="fas fa-tachometer-alt me-1"></i> Dashboard
              </a>
            </li>
            <!-- Add Student link -->
            <li class="nav-item">
              <a class="nav-link" href="add">
                <i class="fas fa-user-plus me-1"></i> Add
              </a>
            </li>
            <!-- View Students link -->
            <li class="nav-item">
              <a class="nav-link" href="view">
                <i class="fas fa-users me-1"></i> View
              </a>
            </li>
            <!-- Search Students link -->
            <li class="nav-item">
              <a class="nav-link" href="search">
                <i class="fas fa-search me-1"></i> Search
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- ============================================
         EDIT STUDENT FORM SECTION
         ============================================
         Main form container for editing student information.
         Pre-populated with existing student data.
         ============================================ -->
    <div class="container mt-4">
      <!-- Page title -->
      <h2 class="mb-4">Edit Student</h2>

      <!-- Form container card -->
      <div class="card">
        <div class="card-body">
          <!-- ============================================
               FLASH MESSAGES SECTION
               ============================================
               Display system messages (success, error, warning) to user.
               Messages are populated from Flask flash() system.
               ============================================ -->
          {% with messages = get_flashed_messages(with_categories=true) %} {% if
          messages %}
          <div id="flash-messages" style="display: none">
            {% for category, message in messages %}
            <div class="flash-message" data-category="{{ category }}">
              {{ message }}
            </div>
            {% endfor %}
          </div>
          {% endif %} {% endwith %}

          <!-- ============================================
               EDIT STUDENT FORM
               ============================================
               Form for editing existing student information.
               Pre-populated with current student data.
               ============================================ -->
          <form
            id="student-form"
            method="POST"
            action="{{ url_for('edit_student', student_id=student[0]) }}"
          >
            <!-- Student ID and Name Row -->
            <div class="row">
              <!-- Student ID Field (pre-populated) -->
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label for="student_id"
                    >Student ID <span class="required">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="student_id"
                    name="student_id"
                    value="{{ student[1] if student else '' }}"
                    required
                    onblur="checkDuplicateStudentId(this.value, {{ student[0] }})"
                  />
                  <div id="student_id_feedback" class="invalid-feedback"></div>
                </div>
              </div>
              <!-- Student Name Field (pre-populated) -->
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label for="name">Name <span class="required">*</span></label>
                  <input
                    type="text"
                    class="form-control"
                    id="name"
                    name="name"
                    value="{{ student[2] if student else '' }}"
                    required
                  />
                </div>
              </div>
            </div>

            <!-- Age and Email Row -->
            <div class="row">
              <!-- Age Field (pre-populated) -->
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label for="age">Age <span class="required">*</span></label>
                  <input
                    type="number"
                    class="form-control"
                    id="age"
                    name="age"
                    value="{{ student[3] if student else '' }}"
                    required
                    min="1"
                  />
                </div>
              </div>
              <!-- Email Field (pre-populated) -->
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label for="email"
                    >Email <span class="required">*</span></label
                  >
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    name="email"
                    value="{{ student[4] if student else '' }}"
                    required
                    onblur="checkDuplicateEmail(this.value, {{ student[0] }})"
                  />
                  <div id="email_feedback" class="invalid-feedback"></div>
                </div>
              </div>
            </div>

            <!-- Courses Field (pre-populated) -->
            <div class="form-group mb-3">
              <label for="courses">Courses</label>
              <input
                type="text"
                class="form-control"
                placeholder="Enter courses separated by commas"
                id="courses"
                name="courses"
                value="{{ ', '.join(courses) if courses else '' }}"
              />
              <small class="form-text text-muted"
                >Enter course names separated by commas (e.g., Programming, Web
                Development, Quantitative Method)</small
              >
            </div>

            <!-- Form Action Buttons -->
            <div class="d-flex justify-content-end">
              <!-- Update button -->
              <button type="submit" class="btn btn-primary">
                Update Student
              </button>
              <!-- Cancel button (links to student view page) -->
              <a
                href="{{ url_for('view_student', student_id=student[0]) }}"
                class="btn btn-secondary ms-2"
                >Cancel</a
              >
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- ============================================
         NOTIFICATION ELEMENT
         ============================================
         Toast notification system for real-time user feedback.
         Used for validation messages and form submission status.
         ============================================ -->
    <div id="notification" class="notification" style="display: none">
      <div class="d-flex align-items-center">
        <i class="fas fa-check-circle"></i>
        <span id="notification-message"></span>
      </div>
    </div>

    <!-- ============================================
         FOOTER SECTION
         ============================================
         Site footer with copyright, social links, and developer credits.
         ============================================ -->
    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2025 LearnHub| All Rights Reserved</p>
        <div class="social-icons">
          <a href="#"><i class="fab fa-twitter"></i></a>
          <a href="#"><i class="fab fa-linkedin"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
        </div>
        <p>@Paul Mulilo And The LearnHub Team</p>
      </div>
    </footer>

    <!-- ============================================
         SCRIPTS SECTION
         ============================================
         JavaScript libraries and form-specific functionality.
         ============================================ -->
    <!-- Bootstrap JavaScript for form components -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript for form validation and handling -->
    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
    <script>
      // ============================================
      // EDIT FORM JAVASCRIPT INITIALIZATION
      // ============================================
      document.addEventListener("DOMContentLoaded", function () {
        // ============================================
        // FLASH MESSAGE HANDLING
        // ============================================
        // Convert Flask flash messages to toast notifications
        const flashMessages = document.querySelectorAll(
          "#flash-messages .flash-message"
        );
        flashMessages.forEach((msg) => {
          const category = msg.getAttribute("data-category");
          const message = msg.textContent;
          if (category === "success") {
            showNotification(message, "success");
          } else {
            showNotification(message, "error");
          }
        });

        // ============================================
        // FORM VALIDATION
        // ============================================
        // Client-side validation for form submission
        const form = document.getElementById("student-form");
        form.addEventListener("submit", function (e) {
          const studentId = document.getElementById("student_id").value.trim();
          const name = document.getElementById("name").value.trim();
          const age = document.getElementById("age").value;
          const email = document.getElementById("email").value.trim();

          if (!studentId || !name || !age || !email) {
            e.preventDefault();
            showNotification("Please fill in all required fields", "error");
            return false;
          }

          if (age < 1 || age > 120) {
            e.preventDefault();
            showNotification("Please enter a valid age", "error");
            return false;
          }

          // Email format validation
          const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailPattern.test(email)) {
            e.preventDefault();
            showNotification("Please enter a valid email address", "error");
            return false;
          }
        });
      });
    </script>
  </body>
</html>
